////  EventListItem//  Created by Ketan Anjaria on 2007-000-20.//  Copyright (c) 2007 __MyCompanyName__. All rights reserved.//package com.metaweb.samples.soundline {	import flash.display.*		import flash.text.*;	import flash.events.*;	import flash.net.*;		import com.kidbombay.util.*;		import metaliq.core.*		import caurina.transitions.*;	import com.adobe.serialization.json.*;		import com.metaweb.*;		public class EventListItem extends DynamicListItem {		public var labelBG:Sprite;		public var image:ExternalAsset;		public var imageMask:Sprite;		public var dot:Sprite;		/**		 * Creates a new EventListItem component instance.		 * com.metaweb.samples.soundline.EventListItem		 */		public function EventListItem() { 			super();		}		override protected function configUI() : void {			super.configUI();			buttonMode = true;			useHitRegion = true;			mouseChildren = false;			disableOnSelect = false;			label_txt.autoSize = "left";			imageMask.visible = false		}				override public function set dataModel(p_dataModel:*):void{			$dataModel = p_dataModel;						label = $dataModel.label;			var newWidth:Number = label_txt.width + label_txt.x + 2			$width = Math.max(newWidth,0)			labelBG.width = newWidth;			hitRegion.width = newWidth + hitRegion.x*-1;		}				protected var $offsetY:Number;		public function set offsetY(p_offsetY:Number):void{			$offsetY = p_offsetY;			label_txt.y+= $offsetY;			labelBG.y = label_txt.y - 2;			hitRegion.y += $offsetY;			dot.y+= $offsetY;		}		public function get offsetY():Number{			return $offsetY;		}		protected var $imageY:Number;		public function set imageY(p_imageY:Number):void{			$imageY = p_imageY;			imageMask.y = $imageY;		}		public function get imageY():Number{			return $imageY;		}		protected var $albumRows:Number=0;		public function set albumRows(p_albumRows:Number):void{			$albumRows = p_albumRows;					}		public function get albumRows():Number{			return $albumRows;		}		override public function draw() : void {						super.draw();		}		public function showEvent(p_show:Boolean):void{						if(p_show) {				var images:Array = $dataModel["/common/topic/image"];				if(image == null && images.length > 0) {										image = new ExternalAsset();					var imageHighlight = new ImageHighlight();					image.addChild(imageHighlight);										image.setSize(100,100);					image.y = -image.height;					image.addEventListener("complete", onLoadImage, false, 0, true);					image.mask = imageMask;					imageMask.visible = true;					addChild(image)										loadImage(DataManager.getThumbURL(images[0].guid,image.width,image.height))										} else if( image != null ){														showImage();				}			} else {				// hide image				if(image!= null) Tweener.addTween(image, { y: -image.height,time:.5, transition:"easeOutBack",delay:index*.000});			}		}		public function get hasImage():Boolean{			return image != null;		}		public function loadImage(p_url:String):void{						if(!Environment.isInBrowser() ) {				image.load("content/outlandos.jpg")			} else {				image.load(p_url);			}						image.visible = false;					}		private function onLoadImage(p_event:Event):void{			showImage()		}		public function showImage():void{						image.visible = true;			var newY:Number = $imageY + ((image.height+10) * albumRows)			imageMask.height = (image.height+10) * (albumRows+1)			Tweener.addTween(image, { y:newY,time:.5, transition:"easeOutBack",delay:index*.000});		}			}}